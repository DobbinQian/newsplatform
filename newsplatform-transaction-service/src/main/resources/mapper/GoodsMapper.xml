<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.qdbgame.newsplatform.dao.GoodsMapper">

    <resultMap id="BaseResultMap" type="com.qdbgame.newsplatform.entities.Goods">
        <result column="goods_id" property="goodsId"/>
        <result column="own_id" property="ownId"/>
        <result column="own_type" property="ownType"/>
        <result column="goods_type" property="type"/>
        <result column="item_id" property="itemId"/>
        <result column="goods_name" property="name"/>
        <result column="goods_describe" property="describe"/>
        <result column="goods_price" property="price"/>
        <result column="inventory" property="inventory"/>
        <result column="shelf_time" property="shelfTime"/>
        <result column="start_time" property="startTime"/>
        <result column="end_time" property="endTime"/>
        <result column="sale_count" property="saleCount"/>
        <result column="state" property="state"/>
    </resultMap>

    <insert id="insert" parameterType="com.qdbgame.newsplatform.entities.Goods">
        INSERT INTO goods
        <trim prefix="(" suffix=")" suffixOverrides="," >
            own_id,
            own_type,
            goods_type,
            <if test="itemId != null">
                item_id,
            </if>
            goods_name,
            goods_describe,
            goods_price,
            <if test="inventory != null">
                inventory,
            </if>
            <if test="shelfTime != null">
                shelf_time,
            </if>
            <if test="startTime != null">
                start_time,
            </if>
            <if test="endTime != null">
                end_time,
            </if>
            <if test="state != null">
                state,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides="," >
            #{ownId},
            #{ownType},
            #{type},
            <if test="itemId != null">
                #{itemId},
            </if>
            #{name},
            #{describe},
            #{price},
            <if test="inventory != null">
                #{inventory},
            </if>
            <if test="shelfTime != null">
                #{shelfTime},
            </if>
            <if test="startTime != null">
                #{startTime},
            </if>
            <if test="endTime != null">
                #{endTime},
            </if>
            <if test="state != null">
                #{state},
            </if>
        </trim>
    </insert>

    <update id="update" parameterType="com.qdbgame.newsplatform.entities.Goods">
        UPDATE goods
        <set>
            <if test="ownId != null">
                own_id = #{ownId},
            </if>
            <if test="name != null and name != ''">
                goods_name = #{name},
            </if>
            <if test="describe != null and describe != ''">
                goods_describe = #{describe},
            </if>
            <if test="price != null">
                goods_price = #{price},
            </if>
            <if test="inventory != null">
                inventory = #{inventory},
            </if>
            <if test="saleCount != null">
                sale_count = #{saleCount},
            </if>
            <if test="state != null">
                state = #{state},
            </if>
        </set>
        WHERE goods_id = #{goodsId}
    </update>

    <select id="getGoodsList" resultMap="BaseResultMap">
        SELECT *
        FROM goods
        WHERE goods_type = #{type} AND state = 0
        ORDER BY start_time
        LIMIT #{pageNo},#{pageSize}
    </select>

    <select id="getGoodsInfoById" resultMap="BaseResultMap">
        SELECT *
        FROM goods
        WHERE goods_id = #{goodsId}
    </select>


</mapper>